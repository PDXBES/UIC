# ---------------------------------------------------------------------------
# 08. CalcProxtoWetlands.py
# Created on: Tue Apr 16 2013 05:30:57 PM
#   (generated by ArcGIS/ModelBuilder)
# ---------------------------------------------------------------------------

# Import system modules
import sys, string, os, arcgisscripting

# Create the Geoprocessor object
gp = arcgisscripting.create()

# Set the necessary product code
gp.SetProduct("ArcInfo")

# Load required toolboxes...
gp.AddToolbox("C:/Program Files (x86)/ArcGIS/ArcToolbox/Toolboxes/Data Management Tools.tbx")
gp.AddToolbox("C:/Program Files (x86)/ArcGIS/ArcToolbox/Toolboxes/Analysis Tools.tbx")


# Local variables...
UIC = "UIC"
UICReg = "\\\\cassio\\gis2\\PROJECTS\\7750\\Registrations\\UIC_Locator.mdb\\UIC_Registration_Spatial"
UIC_near_Wetland = "UIC"
WetlandsPDX_pt = "\\\\Cassio\\gis2\\PROJECTS\\7750\\UIC_DB\\UIC_DATABASE_91.mdb\\Wetlands_pdx_pt"
WetlandsPDX = "\\\\Cassio\\gis2\\PROJECTS\\7750\\UIC_DB\\UIC_DATABASE_91.mdb\\Wetlands_pdx_clip"
UIC_wetl_Int = "\\\\cassio\\gis2\\PROJECTS\\7750\\Registrations\\UIC_Locator.mdb\\UIC_wetl_Int"
UIC_View_Done = "UIC_Registration_Spatial_View"
UIC_Update_View = "UIC_Registration_Spatial_View"
UIC_wetl_Int_View = "UIC_wetl_Int_View"
UIC_View = "UIC_Registration_Spatial_View"

# Process: Make Table View (2)...
gp.MakeTableView_management(UICReg, UIC_View, "", "", "regID regID VISIBLE NONE;regIDFull regIDFull VISIBLE NONE;userID userID VISIBLE NONE;createdDate createdDate VISIBLE NONE;siteAddress siteAddress VISIBLE NONE;uicType uicType VISIBLE NONE;latDD latDD VISIBLE NONE;longDD longDD VISIBLE NONE;latDMS latDMS VISIBLE NONE;longDMS longDMS VISIBLE NONE;latFeet latFeet VISIBLE NONE;longFeet longFeet VISIBLE NONE;uicDepth uicDepth VISIBLE NONE;uicDiameter uicDiameter VISIBLE NONE;elevation elevation VISIBLE NONE;designDrainageRateCFS designDrainageRateCFS VISIBLE NONE;designDrainageRateGPM designDrainageRateGPM VISIBLE NONE;testDrainageRateCFS testDrainageRateCFS VISIBLE NONE;testDrainageRateGPM testDrainageRateGPM VISIBLE NONE;impAreaAcres impAreaAcres VISIBLE NONE;uicPretreatmentType1 uicPretreatmentType1 VISIBLE NONE;uicPretreatmentType2 uicPretreatmentType2 VISIBLE NONE;nearDWWellID nearDWWellID VISIBLE NONE;nearDWWell nearDWWell VISIBLE NONE;dwWellOwnerType dwWellOwnerType VISIBLE NONE;nearIrrWellID nearIrrWellID VISIBLE NONE;nearIrrWell nearIrrWell VISIBLE NONE;irrWellOwnerType irrWellOwnerType VISIBLE NONE;nearPotentialWellID nearPotentialWellID VISIBLE NONE;nearPotentialWell nearPotentialWell VISIBLE NONE;potentialWellOwnerType potentialWellOwnerType VISIBLE NONE;nearWellTaxlotID nearWellTaxlotID VISIBLE NONE;nearWellTaxlot nearWellTaxlot VISIBLE NONE;wellTaxlotOwnerType wellTaxlotOwnerType VISIBLE NONE;nearECSIID nearECSIID VISIBLE NONE;nearECSI nearECSI VISIBLE NONE;inTOT inTOT VISIBLE NONE;genZone genZone VISIBLE NONE;streetType streetType VISIBLE NONE;approvedByID approvedByID VISIBLE NONE;approvalDate approvalDate VISIBLE NONE;wellNumber wellNumber VISIBLE NONE;deqID deqID VISIBLE NONE;unitID unitID VISIBLE NONE;projectNumber projectNumber VISIBLE NONE;comments comments VISIBLE NONE;nearWetland nearWetland VISIBLE NONE;nearSurfaceWater nearSurfaceWater VISIBLE NONE;gwDepth2008 gwDepth2008 VISIBLE NONE;gwVar2008 gwVar2008 VISIBLE NONE;sepDist2008 sepDist2008 VISIBLE NONE;gwDepth2007 gwDepth2007 VISIBLE NONE;gwVar2007 gwVar2007 VISIBLE NONE;sepDist2007 sepDist2007 VISIBLE NONE;gwDepthCSM gwDepthCSM VISIBLE NONE;sepDistCSM sepDistCSM VISIBLE NONE;altRegID altRegID VISIBLE NONE;POINT_X POINT_X VISIBLE NONE;POINT_Y POINT_Y VISIBLE NONE")

# Process: Make Feature Layer...
gp.MakeFeatureLayer_management(UICReg, UIC, "[regIDFull] IS NULL", "", "regID regID VISIBLE NONE;regIDFull regIDFull VISIBLE NONE;userID userID VISIBLE NONE;createdDate createdDate VISIBLE NONE;siteAddress siteAddress VISIBLE NONE;uicType uicType VISIBLE NONE;latDD latDD VISIBLE NONE;longDD longDD VISIBLE NONE;latDMS latDMS VISIBLE NONE;longDMS longDMS VISIBLE NONE;latFeet latFeet VISIBLE NONE;longFeet longFeet VISIBLE NONE;uicDepth uicDepth VISIBLE NONE;uicDiameter uicDiameter VISIBLE NONE;elevation elevation VISIBLE NONE;designDrainageRateCFS designDrainageRateCFS VISIBLE NONE;designDrainageRateGPM designDrainageRateGPM VISIBLE NONE;testDrainageRateCFS testDrainageRateCFS VISIBLE NONE;testDrainageRateGPM testDrainageRateGPM VISIBLE NONE;impAreaAcres impAreaAcres VISIBLE NONE;uicPretreatmentType1 uicPretreatmentType1 VISIBLE NONE;uicPretreatmentType2 uicPretreatmentType2 VISIBLE NONE;nearDWWellID nearDWWellID VISIBLE NONE;nearDWWell nearDWWell VISIBLE NONE;dwWellOwnerType dwWellOwnerType VISIBLE NONE;nearIrrWellID nearIrrWellID VISIBLE NONE;nearIrrWell nearIrrWell VISIBLE NONE;irrWellOwnerType irrWellOwnerType VISIBLE NONE;nearPotentialWellID nearPotentialWellID VISIBLE NONE;nearPotentialWell nearPotentialWell VISIBLE NONE;potentialWellOwnerType potentialWellOwnerType VISIBLE NONE;nearWellTaxlotID nearWellTaxlotID VISIBLE NONE;nearWellTaxlot nearWellTaxlot VISIBLE NONE;wellTaxlotOwnerType wellTaxlotOwnerType VISIBLE NONE;nearECSIID nearECSIID VISIBLE NONE;nearECSI nearECSI VISIBLE NONE;inTOT inTOT VISIBLE NONE;genZone genZone VISIBLE NONE;streetType streetType VISIBLE NONE;approvedByID approvedByID VISIBLE NONE;approvalDate approvalDate VISIBLE NONE;wellNumber wellNumber VISIBLE NONE;deqID deqID VISIBLE NONE;unitID unitID VISIBLE NONE;projectNumber projectNumber VISIBLE NONE;comments comments VISIBLE NONE;nearWetland nearWetland VISIBLE NONE;nearSurfaceWater nearSurfaceWater VISIBLE NONE;gwDepth2008 gwDepth2008 VISIBLE NONE;gwVar2008 gwVar2008 VISIBLE NONE;sepDist2008 sepDist2008 VISIBLE NONE;gwDepth2007 gwDepth2007 VISIBLE NONE;gwVar2007 gwVar2007 VISIBLE NONE;sepDist2007 sepDist2007 VISIBLE NONE;gwDepthCSM gwDepthCSM VISIBLE NONE;sepDistCSM sepDistCSM VISIBLE NONE;altRegID altRegID VISIBLE NONE;POINT_X POINT_X VISIBLE NONE;POINT_Y POINT_Y VISIBLE NONE")

# Process: distanceToWetlands...
gp.Near_analysis(UIC, "\\\\Cassio\\gis2\\PROJECTS\\7750\\UIC_DB\\UIC_DATABASE_91.mdb\\Wetlands_pdx_pt", "", "LOCATION", "NO_ANGLE")

# Process: Intersect...
gp.Intersect_analysis("\\\\Cassio\\gis2\\PROJECTS\\7750\\UIC_DB\\UIC_DATABASE_91.mdb\\Wetlands_pdx_clip #;UIC #", UIC_wetl_Int, "ALL", "", "INPUT")

# Process: Make Table View...
gp.MakeTableView_management(UIC_wetl_Int, UIC_wetl_Int_View, "", "", "FID_Wetlands_pdx_clip FID_Wetlands_pdx_clip VISIBLE NONE;OBJECTID OBJECTID VISIBLE NONE;CODE CODE VISIBLE NONE;NAME NAME VISIBLE NONE;LLID LLID VISIBLE NONE;SOURCE SOURCE VISIBLE NONE;SOURCE_REF SOURCE_REF VISIBLE NONE;NHD_FCODE NHD_FCODE VISIBLE NONE;WS_ID WS_ID VISIBLE NONE;HUC12 HUC12 VISIBLE NONE;HUC12_NAME HUC12_NAME VISIBLE NONE;MODIFIER MODIFIER VISIBLE NONE;MOD_NAME MOD_NAME VISIBLE NONE;MOD_DATE MOD_DATE VISIBLE NONE;CREATED_BY CREATED_BY VISIBLE NONE;CREATEDATE CREATEDATE VISIBLE NONE;FIELD_DATE FIELD_DATE VISIBLE NONE;REVIEW REVIEW VISIBLE NONE;NOTES NOTES VISIBLE NONE;SUBAREA SUBAREA VISIBLE NONE;Shape_Leng Shape_Leng VISIBLE NONE;Shape_Length Shape_Length VISIBLE NONE;Shape_Area Shape_Area VISIBLE NONE;FID_UIC_Registration_Spatial FID_UIC_Registration_Spatial VISIBLE NONE;regID regID VISIBLE NONE;regIDFull regIDFull VISIBLE NONE;userID userID VISIBLE NONE;createdDate createdDate VISIBLE NONE;siteAddress siteAddress VISIBLE NONE;uicType uicType VISIBLE NONE;latDD latDD VISIBLE NONE;longDD longDD VISIBLE NONE;latDMS latDMS VISIBLE NONE;longDMS longDMS VISIBLE NONE;latFeet latFeet VISIBLE NONE;longFeet longFeet VISIBLE NONE;uicDepth uicDepth VISIBLE NONE;uicDiameter uicDiameter VISIBLE NONE;elevation elevation VISIBLE NONE;designDrainageRateCFS designDrainageRateCFS VISIBLE NONE;designDrainageRateGPM designDrainageRateGPM VISIBLE NONE;testDrainageRateCFS testDrainageRateCFS VISIBLE NONE;testDrainageRateGPM testDrainageRateGPM VISIBLE NONE;impAreaAcres impAreaAcres VISIBLE NONE;uicPretreatmentType1 uicPretreatmentType1 VISIBLE NONE;uicPretreatmentType2 uicPretreatmentType2 VISIBLE NONE;nearDWWellID nearDWWellID VISIBLE NONE;nearDWWell nearDWWell VISIBLE NONE;dwWellOwnerType dwWellOwnerType VISIBLE NONE;nearIrrWellID nearIrrWellID VISIBLE NONE;nearIrrWell nearIrrWell VISIBLE NONE;irrWellOwnerType irrWellOwnerType VISIBLE NONE;nearPotentialWellID nearPotentialWellID VISIBLE NONE;nearPotentialWell nearPotentialWell VISIBLE NONE;potentialWellOwnerType potentialWellOwnerType VISIBLE NONE;nearWellTaxlotID nearWellTaxlotID VISIBLE NONE;nearWellTaxlot nearWellTaxlot VISIBLE NONE;wellTaxlotOwnerType wellTaxlotOwnerType VISIBLE NONE;nearECSIID nearECSIID VISIBLE NONE;nearECSI nearECSI VISIBLE NONE;inTOT inTOT VISIBLE NONE;genZone genZone VISIBLE NONE;streetType streetType VISIBLE NONE;approvedByID approvedByID VISIBLE NONE;approvalDate approvalDate VISIBLE NONE;wellNumber wellNumber VISIBLE NONE;deqID deqID VISIBLE NONE;unitID unitID VISIBLE NONE;projectNumber projectNumber VISIBLE NONE;comments comments VISIBLE NONE;nearWetland nearWetland VISIBLE NONE;nearSurfaceWater nearSurfaceWater VISIBLE NONE;gwDepth2008 gwDepth2008 VISIBLE NONE;gwVar2008 gwVar2008 VISIBLE NONE;sepDist2008 sepDist2008 VISIBLE NONE;gwDepth2007 gwDepth2007 VISIBLE NONE;gwVar2007 gwVar2007 VISIBLE NONE;sepDist2007 sepDist2007 VISIBLE NONE;gwDepthCSM gwDepthCSM VISIBLE NONE;sepDistCSM sepDistCSM VISIBLE NONE;altRegID altRegID VISIBLE NONE;POINT_X POINT_X VISIBLE NONE;POINT_Y POINT_Y VISIBLE NONE;NEAR_FID NEAR_FID VISIBLE NONE;NEAR_DIST NEAR_DIST VISIBLE NONE;NEAR_X NEAR_X VISIBLE NONE;NEAR_Y NEAR_Y VISIBLE NONE")

# Process: Add Join...
gp.AddJoin_management(UIC_View, "NEAR_FID", UIC_wetl_Int_View, "NEAR_FID", "KEEP_ALL")

# Process: Calculate nearWetland...
gp.CalculateField_management(UIC_Update_View, "UIC_Registration_Spatial.nearWetland", "output", "VB", "Dim output as Double\\nIf IsNull ([UIC_wetl_Int.ObjectID]) or IsEmpty ([UIC_wetl_Int.ObjectID]) or ([UIC_wetl_Int.ObjectID]) = \"\" Then\\noutput = [UIC_Registration_Spatial.NEAR_DIST] * 1\\nElse\\noutput = [UIC_Registration_Spatial.NEAR_DIST] * -1\\nEnd If")

